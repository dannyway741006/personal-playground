import{d as f,f as T,o as h,aa as M,M as P,ag as O,A as y,l as u,ai as _,y as w,t as A,_ as E}from"./index-DVPTQ2nu.js";import{A as m,B as N,V as d,E as R,S,C as I,a as B,P as j,b as x,c as L,T as z,M as C,d as v,K as U,u as V}from"./apiStore-CioSR-2T.js";import"./_commonjsHelpers-B5BZiXCZ.js";const D=`precision highp float;

// Attributes
attribute vec3 position;
attribute vec2 uv;

// Uniforms
uniform mat4 worldViewProjection;

// Varying
varying vec2 vUV;

void main() {
  vUV = uv;
  gl_Position = worldViewProjection * vec4(position, 1.0);
}`,k={jsDecoderModule:"/js/babylon.ktx2Decoder.js",jsMSCTranscoder:"/js/msc_basis_transcoder.js",wasmMSCTranscoder:"/js/msc_basis_transcoder.wasm",wasmUASTCToASTC:"/js/msc_basis_transcoder.wasm",wasmUASTCToBC7:"/js/msc_basis_transcoder.wasm",wasmUASTCToRGBA_UNORM:"/js/msc_basis_transcoder.wasm",wasmUASTCToRGBA_SRGB:"/js/msc_basis_transcoder.wasm",wasmUASTCToRGB_A_UNORM:"/js/msc_basis_transcoder.wasm"};U.URLConfig=k;const H=(t,c,n,i,o,r)=>{const s=new m(`animate-${n}`,n,60,m.ANIMATIONTYPE_VECTOR3,m.ANIMATIONLOOPMODE_CONSTANT),a=[{frame:0,value:i},{frame:r,value:o}];s.setKeys(a),c.animations=[s],t.beginAnimation(c,0,r,!1)},F=(t,c,n,i,o)=>{const r=t?i/2:i*.65,s=(a,l)=>{H(o,a,"position",a.position,new d(0,l,0),30)};s(c,r),s(n,-r)},e={engine:null,scene:null,camera:null,canvas:null,model:null,vuePbrMaterial:null,vueConeTop:null,vueConeBottom:null,vueHeight:1,vueSize:1,createScene:async(t,c)=>{console.log("useVertexShader::",D),e.engine=new R(t,!0,{},!0),e.scene=new S(e.engine),e.scene.clearColor=new I(0,0,0,0),e.camera=new B("camera",Math.PI/2,Math.PI/2,4,new d(0,0,0),e.scene),e.engine.setHardwareScalingLevel(1/window.devicePixelRatio),e.camera.attachControl(t,!0),e.camera.setTarget(new d(0,0,0)),e.camera.minZ=.1,e.camera.lowerRadiusLimit=1.15,e.camera.upperRadiusLimit=4,e.camera.wheelDeltaPercentage=.1,e.camera.fov=.95,e.camera.wheelPrecision=100;const n=new j("pbrMaterial",e.scene),i=x.CreateFromPrefilteredData("/images/env/hdr.env",e.scene);n.reflectionTexture=i,n.metallic=.4,n.roughness=.2,n.albedoColor=new L(205/255,0,0),e.vuePbrMaterial=n;const o=new z("parent",e.scene);o.setPivotPoint(new d(0,0,0));const r=C.CreateCylinder("coneTop",{diameterTop:0,diameterBottom:e.vueSize,height:e.vueHeight,tessellation:4},e.scene);r.material=n,r.position=new d(0,e.vueHeight/2,0),r.parent=o,e.vueConeTop=r;const s=C.CreateCylinder("coneBottom",{diameterTop:0,diameterBottom:e.vueSize,height:e.vueHeight,tessellation:4},e.scene);s.material=n,s.position=new d(0,-e.vueHeight/2,0),s.rotation.x=Math.PI,s.parent=o,e.vueConeBottom=s,e.camera.getTarget(),e.camera.alpha,e.camera.beta,e.camera.radius,e.scene.onPointerObservable.add(a=>{const l=e.camera;if(a.type===v.POINTERDOWN&&(console.log("heart down~~~~~"),e.camera))return e.camera.inertia=.9;if(a.type===v.POINTERUP&&(console.log("heart down~~~~~"),e.camera))return e.camera.inertia=.2;(a.type===v.POINTERMOVE||a.type===v.POINTERPICK)&&l&&(l.radius,l.alpha,l.beta,l.target),a.type===v.POINTERWHEEL&&l&&l.radius}),t&&(t.addEventListener("wheel",a=>a.preventDefault()),e.engine.runRenderLoop(()=>{e.scene&&e.scene.render()}),window.addEventListener("orientationchange",()=>{let a=setTimeout(()=>{e.engine?.resize(),clearTimeout(a)},500)}),window.addEventListener("resize",()=>{let a=setTimeout(()=>{e.engine?.resize(),clearTimeout(a)},500)}))},createAnimations:()=>{console.log("animation::");const t=[];return t.push(e.createAnimation("targetAnim","target",80,m.ANIMATIONTYPE_VECTOR3,e.camera?.target,new d(0,0,0))),t.push(e.createAnimation("radiusAnim","radius",80,m.ANIMATIONTYPE_FLOAT,e.camera?.radius,4)),t.push(e.createAnimation("alphaAnim","alpha",80,m.ANIMATIONTYPE_FLOAT,e.camera?.alpha,Math.PI/2)),t.push(e.createAnimation("betaAnim","beta",80,m.ANIMATIONTYPE_FLOAT,e.camera?.beta,Math.PI/2)),t},createAnimation:(t,c,n,i,o,r)=>{const s=new m(t,c,n,i,m.ANIMATIONLOOPMODE_CONSTANT),a=[{frame:0,value:o},{frame:100,value:r}];s.setKeys(a);var l=new N(.5,0,.5,1);return s.setEasingFunction(l),s},appModelReset:()=>{e.scene?.beginDirectAnimation(e.camera,e.createAnimations(),0,100,!1)},disposeModel:()=>{console.log("dispose"),window.removeEventListener("resize",()=>e.engine?.resize()),e.model?.dispose(!0,!0),e.camera?.dispose(),e.scene?.dispose(),e.engine?.dispose(),e.vuePbrMaterial?.dispose(!0,!0),e.vueConeTop?.dispose(!0,!0),e.vueConeBottom?.dispose(!0,!0),e.model=null,e.camera=null,e.scene=null,e.engine=null,e.canvas=null,e.vuePbrMaterial=null,e.vueConeTop=null,e.vueConeBottom=null,e.vueHeight=1,e.vueSize=1}},K={class:"babylonWrapper"},Y={class:"babylon__wrapper"},G=["src"],W=["src"],$={name:"Model"},Z=f({...$,setup(t){const c=T({zh_cht:{id:1,open:{name:"收合",url:"/images/model.png"},close:{name:"展開",url:"/images/close-model.png"},reset:{name:"Reset",url:"/images/icon/360.png"}},en:{id:1,open:{name:"close",url:"/images/model.png"},close:{name:"open",url:"/images/close-model.png"},reset:{name:"Reset",url:"/images/icon/360.png"}}}),n=V(),i=T("close"),o=T(!1),r=T(!1),s=()=>{o.value=!0,r.value=!0,e.appModelReset(),a()},a=()=>{e.scene&&e.vuePbrMaterial&&F(o.value,e.vueConeTop,e.vueConeBottom,e.vueHeight,e.scene),o.value?i.value="close":i.value="open",o.value=!o.value},l=async()=>{const g=document.getElementById("modelCanvas");await e.createScene(g,n)};return h(async()=>{M(()=>{let g=setTimeout(()=>{l(),clearTimeout(g)},10)})}),P(async()=>{e.disposeModel()}),(g,p)=>(y(),O("section",K,[p[2]||(p[2]=u("canvas",{id:"modelCanvas"},null,-1)),u("div",Y,[u("div",{class:"babylon__btn d-flex justify-center align-center",onClick:p[0]||(p[0]=_(b=>a(),["stop"]))},[u("img",{src:c.value[w(n).locale]?.[i.value]?.url,alt:"icon"},null,8,G),u("p",null,A(c.value[w(n).locale]?.[i.value].name),1)]),u("div",{class:"babylon__btn d-flex justify-center align-center reset_btn",onClick:p[1]||(p[1]=_(b=>s(),["stop"]))},[u("img",{src:c.value[w(n).locale]?.reset?.url,alt:"icon"},null,8,W),u("p",null,A(c.value[w(n).locale]?.reset.name),1)])])]))}}),X=E(Z,[["__scopeId","data-v-189136c9"]]);export{X as default};
